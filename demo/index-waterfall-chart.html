<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

        <title>plutonium-waterfall-chart demo</title>

        <script src="../../webcomponentsjs/webcomponents-lite.js"></script>

        <link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html">
        <link rel="import" href="../../iron-demo-helpers/demo-snippet.html">
        <link rel="import" href="../../plutonium-websocket/plutonium-websocket.html">
        <link rel="import" href="../plutonium-chart-widget.html">

        <style is="custom-style" include="demo-pages-shared-styles">
        </style>
    </head>
    <body>
        <div class="vertical-section-container centered">




            <h3>Basic plutonium-waterfall-chart demo</h3>




            <demo-snippet>
                <template>
                    <button id="updateButton">Update</button>
                    <plutonium-websocket id="dataWs" url="ws://localhost:9006/data" as-json auto-close></plutonium-websocket>
                    <!--<plutonium-websocket id="dataWs" url="ws://localhost:8080/hedgehog-visualization-ms-0.0.1-SNAPSHOT/data" as-json auto-close></plutonium-websocket>-->
                    <div id="chart1" is="plutonium-waterfall-chart" class="card"></div>
                    <script>
                        var updateButton = document.querySelector('#updateButton');
                        var chart1 = document.querySelector('div#chart1');
                        updateButton.addEventListener('click', function () {
                            console.log('Update waterfall');
                            chart1.update({
                                "deltaRows": 1, 
                                "domains": {
                                    "x": [{"name": "0", "value": 0}, {"name": "1", "value": 1}, {"name": "2", "value": 2}, {"name": "3", "value": 3}, {"name": "4", "value": 4}, {"name": "5", "value": 5}, {"name": "6", "value": 6}, {"name": "7", "value": 7}, {"name": "8", "value": 8}, {"name": "9", "value": 9}], 
                        });

                        var wsElement = document.querySelector("plutonium-websocket");
                        wsElement.addEventListener('ws-error', function (error) {
                            console.log('Ws throw error');
                            throw new Error(error);
                        });
                        wsElement.addEventListener('ws-open', function () {
                            console.log('Ws send');
                        });
                        wsElement.addEventListener('ws-message', function (message) {
                            console.log('Ws message');
                            chart1.update(message.detail);
                            // hello from the server
                            console.log(message.detail);
                        });
                    </script>
                </template>

            </demo-snippet>






            <demo-snippet>
                <template is="dom-bind">
                    <!--<template>-->
                    <plutonium-datasource source-url="./waterfall.json" source-type="json" last-data="{{waterfallData}}"></plutonium-datasource>
                    <div id="chart0" is="plutonium-waterfall-chart" data="[[waterfallData]]"></div>


                </template>

            </demo-snippet>




        </div>
    </body>
</html>
